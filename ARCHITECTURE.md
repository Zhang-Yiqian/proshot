# ProShot + Dify æ¶æ„è¯´æ˜

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å‰ç«¯ (Next.js)                            â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ä¸Šä¼ ç»„ä»¶    â”‚    â”‚  åœºæ™¯é€‰æ‹©    â”‚    â”‚  ç”»å¸ƒæ¸²æŸ“    â”‚         â”‚
â”‚  â”‚ Upload Zone  â”‚â”€â”€â”€â–¶â”‚Config Panel  â”‚â”€â”€â”€â–¶â”‚  Canvas      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                   â”‚                    â–²                 â”‚
â”‚         â”‚                   â”‚                    â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                             â–¼                                       â”‚
â”‚                   handleGenerate()                                  â”‚
â”‚                             â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ POST /api/generate/dify
                              â”‚ { originalImageUrl, sceneType }
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯ API (Next.js API Routes)                    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  /app/api/generate/dify/route.ts                        â”‚      â”‚
â”‚  â”‚                                                          â”‚      â”‚
â”‚  â”‚  1. éªŒè¯ç”¨æˆ·èº«ä»½ (Supabase Auth)                        â”‚      â”‚
â”‚  â”‚  2. åˆ›å»ºç”Ÿæˆè®°å½• (generations è¡¨)                       â”‚      â”‚
â”‚  â”‚  3. åœºæ™¯æ˜ å°„ (buildScenePrompt)                         â”‚      â”‚
â”‚  â”‚     sceneType: "street"                                 â”‚      â”‚
â”‚  â”‚     â†’ "éƒ½å¸‚è¡—å¤´åœºæ™¯ï¼Œç°ä»£æ—¶å°šé£æ ¼ï¼Œè‡ªç„¶å…‰çº¿"             â”‚      â”‚
â”‚  â”‚  4. è°ƒç”¨ Dify å·¥ä½œæµ (runDifyWorkflow)                  â”‚      â”‚
â”‚  â”‚  5. æ›´æ–°ç”Ÿæˆè®°å½•çŠ¶æ€                                     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                             â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ POST https://api.dify.ai/v1/workflows/run
                              â”‚ {
                              â”‚   inputs: {
                              â”‚     image_url: "https://...",
                              â”‚     scene: "éƒ½å¸‚è¡—å¤´åœºæ™¯..."
                              â”‚   }
                              â”‚ }
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Dify å·¥ä½œæµå¹³å°                               â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å¼€å§‹   â”‚â”€â”€â”€â–¶â”‚ æç¤ºè¯æ„å»º â”‚â”€â”€â”€â–¶â”‚ Gemini 2.5   â”‚â”€â”€â”€â–¶â”‚ è¾“å‡º   â”‚  â”‚
â”‚  â”‚ Start  â”‚    â”‚ Prompt     â”‚    â”‚ Pro ç”Ÿå›¾     â”‚    â”‚ Output â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â–²               â”‚                   â”‚                 â”‚       â”‚
â”‚      â”‚               â”‚                   â”‚                 â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚è¾“å…¥å‚æ•° â”‚    â”‚ æ„å»ºå®Œæ•´æç¤ºè¯:                â”‚   â”‚ç”Ÿæˆå›¾ç‰‡ â”‚ â”‚
â”‚  â”‚ image_urlâ”‚    â”‚ - åŸºç¡€æç¤ºè¯æ¨¡æ¿              â”‚   â”‚ URL     â”‚ â”‚
â”‚  â”‚ scene   â”‚    â”‚ - åœºæ™¯æè¿°: {{scene}}         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ - å‚è€ƒå›¾ç‰‡: {{image_url}}     â”‚               â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Response: { data: { outputs: { image_url } } }
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æ•°æ®æŒä¹…åŒ–                                  â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Supabase Storage    â”‚      â”‚  Supabase Database   â”‚           â”‚
â”‚  â”‚                      â”‚      â”‚                      â”‚           â”‚
â”‚  â”‚  - originals/        â”‚      â”‚  profiles è¡¨:        â”‚           â”‚
â”‚  â”‚    (ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡)     â”‚      â”‚  - ç”¨æˆ·ä¿¡æ¯          â”‚           â”‚
â”‚  â”‚                      â”‚      â”‚  - ç§¯åˆ†ä½™é¢          â”‚           â”‚
â”‚  â”‚  - generated/        â”‚      â”‚                      â”‚           â”‚
â”‚  â”‚    (ç”Ÿæˆå›¾ç‰‡)        â”‚      â”‚  generations è¡¨:     â”‚           â”‚
â”‚  â”‚                      â”‚      â”‚  - ç”Ÿæˆè®°å½•          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  - çŠ¶æ€è·Ÿè¸ª          â”‚           â”‚
â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. å‰ç«¯æ¨¡å—

**æ–‡ä»¶**: `/app/page.tsx`

**èŒè´£**:
- ç”¨æˆ·äº¤äº’ç•Œé¢
- å›¾ç‰‡ä¸Šä¼ 
- åœºæ™¯é€‰æ‹©
- è°ƒç”¨ç”Ÿæˆ API
- æ¸²æŸ“ç”Ÿæˆç»“æœ

**å…³é”®å‡½æ•°**:
```typescript
handleGenerate()  // å¤„ç†ç”Ÿæˆè¯·æ±‚
handleFileSelect()  // å¤„ç†æ–‡ä»¶é€‰æ‹©
```

---

### 2. API è·¯ç”±æ¨¡å—

**æ–‡ä»¶**: `/app/api/generate/dify/route.ts`

**èŒè´£**:
- æ¥æ”¶å‰ç«¯è¯·æ±‚
- ç”¨æˆ·èº«ä»½éªŒè¯
- æ•°æ®åº“è®°å½•ç®¡ç†
- è°ƒç”¨ Dify å·¥ä½œæµ
- é”™è¯¯å¤„ç†

**æ•°æ®æµ**:
```
Request â†’ éªŒè¯ â†’ åˆ›å»ºè®°å½• â†’ è°ƒç”¨ Dify â†’ æ›´æ–°è®°å½• â†’ Response
```

---

### 3. Dify å®¢æˆ·ç«¯æ¨¡å—

**æ–‡ä»¶**: `/lib/ai/dify-client.ts`

**èŒè´£**:
- å°è£… Dify API è°ƒç”¨
- åœºæ™¯æè¿°æ˜ å°„
- å“åº”è§£æ
- Mock æ¨¡å¼æ”¯æŒ

**æ ¸å¿ƒå‡½æ•°**:

#### `runDifyWorkflow()`
```typescript
/**
 * è°ƒç”¨ Dify å·¥ä½œæµ
 * @param input - { originalImageUrl, scene }
 * @returns { success, imageUrl, taskId, error }
 */
```

#### `buildScenePrompt()`
```typescript
/**
 * å°†åœºæ™¯IDè½¬æ¢ä¸ºè¯¦ç»†æè¿°
 * @param sceneId - 'street' | 'home' | 'cafe' | ...
 * @returns åœºæ™¯æè¿°å­—ç¬¦ä¸²
 */
```

---

### 4. æ•°æ®åº“æ¨¡å—

**æ–‡ä»¶**: `/lib/db/generations.ts`, `/lib/db/profiles.ts`

**è¡¨ç»“æ„**:

#### profiles è¡¨
```sql
CREATE TABLE profiles (
  id UUID PRIMARY KEY,
  credits INTEGER DEFAULT 5,
  is_subscriber BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

#### generations è¡¨
```sql
CREATE TABLE generations (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES profiles(id),
  original_image_url TEXT,
  generated_image_url TEXT,
  prompt_used TEXT,
  style_preset TEXT,
  status TEXT CHECK (status IN ('pending', 'completed', 'failed')),
  error_message TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

---

## æ•°æ®æµè½¬è¯¦è§£

### åœºæ™¯ 1: ç”¨æˆ·é¦–æ¬¡ç”Ÿæˆ

```
1. ç”¨æˆ·ä¸Šä¼ æœè£…ç™½åº•å›¾
   â””â”€â–¶ æ–‡ä»¶ä¸Šä¼ åˆ° Supabase Storage (originals/)
   â””â”€â–¶ è·å¾— publicUrl

2. ç”¨æˆ·é€‰æ‹©åœºæ™¯ "street"
   â””â”€â–¶ å‰ç«¯ä¿å­˜ selectedScene = "street"

3. ç”¨æˆ·ç‚¹å‡»"ä¸€é”®ä¸Šé•œ"
   â””â”€â–¶ handleGenerate() æ‰§è¡Œ

4. å‰ç«¯è¯·æ±‚ API
   POST /api/generate/dify
   {
     originalImageUrl: "https://xxx.supabase.co/originals/xxx.jpg",
     sceneType: "street"
   }

5. åç«¯å¤„ç†
   5.1 éªŒè¯ç”¨æˆ·ç™»å½• (Supabase Auth)
   5.2 åˆ›å»º generation è®°å½• (status: 'pending')
   5.3 åœºæ™¯æ˜ å°„
       "street" â†’ "éƒ½å¸‚è¡—å¤´åœºæ™¯ï¼Œç°ä»£æ—¶å°šé£æ ¼ï¼Œè‡ªç„¶å…‰çº¿"
   5.4 è°ƒç”¨ Dify å·¥ä½œæµ
       POST https://api.dify.ai/v1/workflows/run
       {
         inputs: {
           image_url: "https://xxx.supabase.co/originals/xxx.jpg",
           scene: "éƒ½å¸‚è¡—å¤´åœºæ™¯ï¼Œç°ä»£æ—¶å°šé£æ ¼ï¼Œè‡ªç„¶å…‰çº¿"
         },
         response_mode: "blocking"
       }

6. Dify å·¥ä½œæµæ‰§è¡Œ
   6.1 åŠ è½½åŸå›¾
   6.2 æ„å»ºæç¤ºè¯ (æ³¨å…¥ scene æè¿°)
   6.3 è°ƒç”¨ Gemini 2.5 Pro ç”Ÿæˆå›¾ç‰‡
   6.4 è¿”å›ç”Ÿæˆå›¾ç‰‡ URL

7. åç«¯æ›´æ–°è®°å½•
   â””â”€â–¶ æ›´æ–° generation (status: 'completed', generated_image_url)

8. å‰ç«¯æ¸²æŸ“
   â””â”€â–¶ åœ¨ç”»å¸ƒä¸Šæ˜¾ç¤ºç”Ÿæˆçš„å›¾ç‰‡
```

---

## åœºæ™¯é…ç½®

### åœºæ™¯æ˜ å°„è¡¨

| ID | åç§° | å›¾æ ‡ | ä¼ å…¥ Dify çš„æè¿° |
|----|------|------|-----------------|
| `white-bg` | æç®€ç™½åº• | â¬œ | çº¯ç™½èƒŒæ™¯ï¼Œæç®€é£æ ¼ï¼Œçªå‡ºæœè£…ç»†èŠ‚ |
| `street` | è¡—æ‹é£æ ¼ | ğŸ™ï¸ | éƒ½å¸‚è¡—å¤´åœºæ™¯ï¼Œç°ä»£æ—¶å°šé£æ ¼ï¼Œè‡ªç„¶å…‰çº¿ |
| `home` | å±…å®¶åœºæ™¯ | ğŸ  | æ¸©é¦¨å®¶å±…åœºæ™¯ï¼Œèˆ’é€‚è‡ªç„¶æ°›å›´ï¼ŒæŸ”å’Œå…‰çº¿ |
| `cafe` | å’–å•¡é¦† | â˜• | æ–‡è‰ºå’–å•¡é¦†åœºæ™¯ï¼Œå°èµ„æƒ…è°ƒï¼Œæ¸©æš–ç¯å…‰ |
| `office` | å•†åŠ¡åŠå…¬ | ğŸ’¼ | å•†åŠ¡åŠå…¬åœºæ™¯ï¼Œä¸“ä¸šèŒä¸šé£æ ¼ï¼Œæ˜äº®å…‰çº¿ |
| `outdoor` | æˆ·å¤–è‡ªç„¶ | ğŸŒ¿ | æˆ·å¤–è‡ªç„¶åœºæ™¯ï¼Œæ¸…æ–°æ´»åŠ›ï¼Œè‡ªç„¶é˜³å…‰ |

**é…ç½®ä½ç½®**:
- åœºæ™¯é€‰é¡¹å®šä¹‰: `/config/presets.ts`
- åœºæ™¯æè¿°æ˜ å°„: `/lib/ai/dify-client.ts` â†’ `buildScenePrompt()`

---

## ç¯å¢ƒé…ç½®

### å¼€å‘ç¯å¢ƒ

```env
# .env.local

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxx...

# Dify (å¯é€‰ï¼Œä½¿ç”¨ Mock æ¨¡å¼)
DIFY_API_KEY=app-xxx
DIFY_API_BASE_URL=https://api.dify.ai/v1
DIFY_WORKFLOW_ID=workflow-xxx

# Mock æ¨¡å¼
NEXT_PUBLIC_MOCK_MODE=true  # å¼€å¯åä½¿ç”¨å›ºå®šæµ‹è¯•å›¾ç‰‡
```

### ç”Ÿäº§ç¯å¢ƒ

```env
# .env.production

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxx...

# Dify (å¿…é¡»é…ç½®)
DIFY_API_KEY=app-real-key
DIFY_API_BASE_URL=https://api.dify.ai/v1
DIFY_WORKFLOW_ID=workflow-real-id

# ç«™ç‚¹é…ç½®
NEXT_PUBLIC_SITE_URL=https://proshot.example.com

# Mock æ¨¡å¼
NEXT_PUBLIC_MOCK_MODE=false  # å…³é—­ Mock æ¨¡å¼
```

---

## æ‰©å±•å’Œä¼˜åŒ–

### 1. å¼‚æ­¥å¤„ç†

å½“å‰ä½¿ç”¨é˜»å¡æ¨¡å¼ (`response_mode: 'blocking'`)ï¼Œå›¾ç‰‡ç”Ÿæˆéœ€è¦ç­‰å¾… 30-60 ç§’ã€‚

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- æ”¹ç”¨æµå¼æ¨¡å¼ (`response_mode: 'streaming'`)
- åœ¨å‰ç«¯å¢åŠ  WebSocket æˆ–è½®è¯¢æœºåˆ¶
- æ˜¾ç¤ºç”Ÿæˆè¿›åº¦æ¡

### 2. æ‰¹é‡ç”Ÿæˆ

æ”¯æŒä¸€æ¬¡ç”Ÿæˆå¤šå¼ ä¸åŒè§†è§’çš„å›¾ç‰‡ã€‚

**å®ç°æ–¹å¼**:
- ä¿®æ”¹ Dify å·¥ä½œæµï¼Œè¾“å‡ºå¤šå¼ å›¾ç‰‡
- å‰ç«¯æ˜¾ç¤ºç¼©ç•¥å›¾åˆ—è¡¨
- ç”¨æˆ·å¯åˆ‡æ¢æŸ¥çœ‹ä¸åŒè§†è§’

### 3. è‡ªå®šä¹‰åœºæ™¯

å…è®¸ç”¨æˆ·è¾“å…¥è‡ªå®šä¹‰åœºæ™¯æè¿°ã€‚

**å®ç°æ–¹å¼**:
- åœ¨å‰ç«¯å¢åŠ "è‡ªå®šä¹‰"é€‰é¡¹
- æä¾›æ–‡æœ¬è¾“å…¥æ¡†
- ç›´æ¥å°†ç”¨æˆ·è¾“å…¥ä¼ ç»™ Dify å·¥ä½œæµ

### 4. æˆæœ¬ä¼˜åŒ–

**ç­–ç•¥**:
- å¯¹é¢„è§ˆå›¾ä½¿ç”¨è¾ƒå°åˆ†è¾¨ç‡
- ä¸‹è½½é«˜æ¸…å›¾æ—¶æ‰ä½¿ç”¨é«˜åˆ†è¾¨ç‡
- è®¾ç½®æ¯æ—¥/æ¯æœˆè°ƒç”¨é™é¢
- ç›‘æ§ API è°ƒç”¨æ¬¡æ•°

---

## ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—çº§åˆ«

```typescript
// å¼€å‘ç¯å¢ƒï¼šè¾“å‡ºæ‰€æœ‰æ—¥å¿—
console.log('[Dify API] æ”¶åˆ°ç”Ÿæˆè¯·æ±‚')
console.log('[Dify Client] å¼€å§‹è°ƒç”¨å·¥ä½œæµ...')

// ç”Ÿäº§ç¯å¢ƒï¼šå»ºè®®æ¥å…¥æ—¥å¿—æœåŠ¡
// å¦‚ï¼šSentry, LogRocket, Datadog
```

### å…³é”®æŒ‡æ ‡

- API è°ƒç”¨æˆåŠŸç‡
- å¹³å‡ç”Ÿæˆæ—¶é—´
- é”™è¯¯ç±»å‹åˆ†å¸ƒ
- ç”¨æˆ·ä½¿ç”¨çš„åœºæ™¯åˆ†å¸ƒ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-02-11
